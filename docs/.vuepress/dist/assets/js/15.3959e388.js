(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{372:function(e,t,a){"use strict";a.r(t);var s=a(25),n=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"psad-intrusion-detection-with-log-analysis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#psad-intrusion-detection-with-log-analysis"}},[e._v("#")]),e._v(" PSAD Intrusion Detection with Log Analysis")]),e._v(" "),a("TagLinks"),e._v(" "),a("p",[e._v("PSAD is a collection of three lightweight system daemons (two main daemons and one helper daemon) that run on Linux machines and analyze iptables log messages to detect port scans and other suspicious traffic. A typical deployment is to run PSAD on the iptables firewall where it has the fastest access to log data.")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://cipherdyne.org/psad/",target:"_blank",rel:"noopener noreferrer"}},[e._v("PSAD website"),a("OutboundLink")],1),e._v(" "),a("a",{attrs:{href:"https://github.com/mrash/psad",target:"_blank",rel:"noopener noreferrer"}},[e._v("GitHub"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("Setup and configuration has been tested on following OS with version:")]),e._v(" "),a("ul",[a("li",[e._v("Ubuntu- 16.04, 18.04, 20.04")]),e._v(" "),a("li",[e._v("2.2.3 -> 2.4.6")])]),e._v(" "),a("h2",{attrs:{id:"configuration-files"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configuration-files"}},[e._v("#")]),e._v(" Configuration files")]),e._v(" "),a("h2",{attrs:{id:"prerequisites"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[e._v("#")]),e._v(" Prerequisites")]),e._v(" "),a("p",[e._v("Dependancies when installing PSAD from source.")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("net-tools")])]),e._v(" "),a("li",[a("code",[e._v("g++")])])]),e._v(" "),a("h2",{attrs:{id:"install-from-source"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#install-from-source"}},[e._v("#")]),e._v(" Install from source")]),e._v(" "),a("p",[e._v("Make sure you have installed the dependency packages "),a("code",[e._v("sudo apt-get install net-tools & g++")]),e._v(". Once complete download the lastest stable version from the "),a("a",{attrs:{href:"https://github.com/mrash/psad",target:"_blank",rel:"noopener noreferrer"}},[e._v("PSAD GitHub"),a("OutboundLink")],1),e._v(", extract and run the installation script.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("$ wget https://github.com/mrash/psad/archive/2.4.6.tar.gz\n$ tar -zxvf 2.4.6.tar.gz\n$ cd psad-2.4.6/\n$ sudo ./install.pl\n")])])]),a("p",[e._v("Answer the question as it fits (Y) and install the latest signatures.")]),e._v(" "),a("div",{staticClass:"language-console extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Would you like to install the latest signatures from\n    http://www.cipherdyne.org/psad/signatures (y/n)?  y\n")])])]),a("h2",{attrs:{id:"setup-psad"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setup-psad"}},[e._v("#")]),e._v(" Setup PSAD")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("$ sudo apt-get update\n$ sudo apt-get install psad\n")])])]),a("p",[e._v("First enable logging using the built-in UFW command below.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("$ sudo ufw logging on\n")])])]),a("p",[e._v("Once we did enable logging in UFW we also need to alter our UFW rules. Edit both configuration files (before.rules and before6.rules) and add the following before the COMMIT line.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v('$ sudo nano /etc/ufw/before.rules\n\n# custom psad logging directives\n-A INPUT -j LOG --log-tcp-options\n-A INPUT -j LOG --log-tcp-options\n\n# do not delete the "COMMIT" line or these rules wont be processed\nCOMMIT\n')])])]),a("p",[e._v("Now we need to reload UFW and proceed to check psad with the built-in firewall analyze tool.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("$ sudo ufw reload\n$ sudo psad --fw-analyze\n...\n[+] Parsing INPUT chain rules.\n[+] Parsing INPUT chain rules.\n[+] Firewall config looks good.\n[+] Completed check of firewall ruleset.\n[+] Results in /var/log/psad/fw_check\n[+] Exiting.\n")])])]),a("h2",{attrs:{id:"configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configuration"}},[e._v("#")]),e._v(" Configuration")]),e._v(" "),a("p",[e._v("The email address will be left as default (root@localhost;) as we use OSSEC to generate alerts. However, we will still send local server emails if the danger level is 3 or greater.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("$ sudo nano /etc/psad/psad.conf\n\nHOSTNAME    your_domain.com;\nIPT_SYSLOG_FILE\t\t/var/log/syslog;\nEXPECT_TCP_OPTIONS\t\tY; # --log-tcp-options argument\nEMAIL_ALERT_DANGER_LEVEL\t3; # alert if danger >= to this value\n")])])]),a("p",[e._v("To avoid any email reports and only rely on the syslog and OSSEC alerts we can define the alerting method in the psad.conf file.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v('### Allow reporting methods to be enabled/restricted.  This keyword can\n### accept values of "nosyslog" (don\'t write any messages to syslog),\n### "noemail" (don\'t send any email messages), or "ALL" (to generate both\n### syslog and email messages).  "ALL" is the default.  Both "nosyslog"\n### and "noemail" can be combined with a comma to disable all logging\n### and alerting.\nALERTING_METHODS            noemail;\n')])])]),a("p",[e._v("To check the status of PSAD execute the following command.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("$ sudo psad -S\n")])])]),a("h2",{attrs:{id:"recommended-reading"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#recommended-reading"}},[e._v("#")]),e._v(" Recommended reading "),a("Badge",{attrs:{text:"affiliate links",type:"warning"}})],1),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://amzn.to/3gvD0VR",target:"_blank",rel:"noopener noreferrer"}},[e._v("Linux Firewalls, Michael Rash, 2007"),a("OutboundLink")],1)])])],1)}),[],!1,null,null,null);t.default=n.exports}}]);